### 시작하기 전

쿠키, 세션, 토큰들을 알기 전 이러한 것들이 왜 필요한지를 알고 가겠습니다.   
쿠키, 세션, 토큰은 HTTP 통신에서 사용합니다. HTTP 통신을 할 때 인증이 필요한 경우 어떻게 할까요?   
HTTP 통신은 Stateless하기 때문에 매번 인증을 해야합니다. 이러한 불편한 점을 해결하고자 쿠키, 세션, 토큰이 생겨났습니다.

# 쿠키(Cookie)

서버가 웹 브라우저에게 보내주는 작은 데이터 조각입니다. 웹 브라우저는 HTTP 통신을 할 때 언어, 장바구니 내역, 최근 검색 기록, 일주일 간 보지 않기 등을 쿠키에 저장해놓고 다음 요청 때 보낼 수 있습니다. 클라이언트는 매번 설정할 필요 없이 쿠키를 이용하여 간편하게 통신을 할 수 있습니다. 

## 쿠키의 특징

- 동일한 서버에서 받은 쿠키만을 요청시 보내고 다른 서버에는 보내지 않습니다. 
- 로컬에 저장하기 때문에 저장 용량이 작습니다.
- 웹 브라우저에서 쉽게 볼 수 있어 보안에 취약하여 민감한 정보를 넘겨주면 안됩니다.
- 클라이언트가 가지고 있는 것이어서 서버 측에서 신뢰하기 어렵습니다.
- 쿠키는 웹 브라우저에서 사용하는 것이므로 앱에서는 사용할 수 없습니다.

## 쿠키를 통한 인증

`ID` 값 자체를 보내주면 됩니다. 하지만 이 경우 변조가 쉽고 다른 유저의 아이디도 쉽게 찾을 수 있습니다.   
예를 들어, 서버에서 `auto-increment` 로 아이디 값을 생성하고 있을 때 1번 유저는 `ID`:1, 2번 유저는 `ID`:2 가 됩니다. 1번 유저는 쉽게 예측할 수 있고 2번으로 바꾸어 보낸다면 서버에서 2번 유저로 착각하게 되어 매우 위험합니다.

# 세션(Session)

세션은 쿠키의 한 종류라고 볼 수 있습니다. `ID` 값 대신에 유저에게 랜덤값 키를 넘겨줍니다. 이 키는 랜덤값이고 매우 길어 유저가 다른 유저로 변조하기 쉽지 않습니다.

## 세션 통신 방법

1. 서버는 랜덤값으로 세션을 생성하여 저장소에 저장하고, 유저에게 Response로 넘겨줍니다.
2. 유저는 세션 아이디를 다음 통신에 같이 실어 보냅니다.
3. 서버는 요청시 세션 유효검사와 어떤 사용자인지를 저장소에서 찾습니다.

## 세션의 특징

- 중요한 정보를 랜덤값으로 변환하여 서버에 저장해둘 수 있습니다. 쿠키보다 안전합니다.
- 저장소를 들려야 하므로 시간과 공간이 필요합니다. 유저가 늘어날수록 느려질 수 있습니다.
- 계정의 특정 유저를 내쫓을 수 있습니다.(저장소를 통해 세션을 관리하고 있기에 가능)
    - 인스타그램에서는 로그인된 모든 디바이스를 보여주는데 1개만 로그아웃 할 수 있습니다.
    - 넷플릭스에서는 로그인된 사용자 수를 알 수 있고, 현재 시청 중인지 알 수 있습니다.

# 토큰(Token)

토큰은 세션처럼 추적하지 않습니다. 서버는 단지 토큰이 유효한가의 여부만을 검사합니다.   

## 토큰 통신 방법

1. 서버는 데이터를 사인하고 유저에게 보냅니다. 
2. 유저는 재요청시 토큰과 함께 서버에 요청을 보냅니다.(토큰은 쿠키가 아닙니다)
3. 서버는 토큰만으로 유효성을 검사합니다.

## 토큰의 특징

- 저장소가 필요하지 않습니다.(유저가 증가하더라도 세션과 다르게 추가 비용이 들지 않습니다)
- 토큰은 암호화를 하지 않습니다. 중요한 정보를 담아서는 안됩니다.
- 추적하지 않으므로 인스타그램, 넷플릭스와 같은 기능을 사용할 수 없습니다.
- 토큰 사이즈는 쿠키처럼 제약적이지 않습니다. 데이터가 커질 수 있음을 인지해야 합니다.(토큰 사이즈가 커지면 통신시 비용 증가)

## 참조

[세션 vs 토큰 vs 쿠키? 기초개념 잡아드림. 10분 순삭! - 노마드 코더](https://www.youtube.com/watch?v=tosLBcAX1vk)   
[[흑묘테크] Networks : Session, Cookie, Token, JWT (오승연)](https://www.youtube.com/watch?v=M_RMgy4AmPg)   
[Difference between cookies, session and tokens - Valentin Despa](https://www.youtube.com/watch?v=GhrvZ5nUWNg)

## 주의할 점

세션쿠키와 세션은 다른 것이다.   
세션은 서버에서 사용자의 상태를 저장하는 구조이고,   
세션쿠키는 클라이언트 측에서 가지고 있는 쿠키이다.(세션쿠키는 브라우저가 열려있는 동안에만 유지되는 쿠키, 다르게 표현하면 브라우저가 닫힐 때 삭제되는 쿠키)